const Utils = require('../utils')

describe('Chat Screen Tests', () => {
  before(async () => {
    await Utils.reloadApp()
    await Utils.loginAsUser()
  })
  after(async () => {
    await Utils.goBack()
    await Utils.logout()
  })

  beforeEach(async () => {
    await Utils.reloadApp()
    await navigateToChatScreen()
  })

  const navigateToChatScreen = async () => {
    await Utils.waitForSplashScreen();
    await Utils.tapFirstElementByLabel('Menu Button');
    await Utils.tapFirstElementByLabel('Chat');
  }

  const sendChat = async (message) => {
    await element(by.id('chatScreenInput')).replaceText(message)
    await element(by.id('chatScreenSendButton')).tap()
  }

  it('should display the chat screen and message input', async () => {
    await expect(element(by.id('chatScreen'))).toBeVisible()
    await expect(element(by.id('chatScreenInput'))).toBeVisible()
  })

  it('should send a chat message then display it', async () => {
    await sendChat('Java Hipster')
    await expect(element(by.text('Java Hipster'))).toBeVisible()
  })
})
